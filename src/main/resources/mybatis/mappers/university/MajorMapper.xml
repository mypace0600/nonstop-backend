<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.nonstop.mapper.MajorMapper">

    <resultMap id="majorResultMap" type="com.app.nonstop.domain.major.entity.Major">
        <id property="id" column="id"/>
        <result property="universityId" column="university_id"/>
        <result property="name" column="name"/>
    </resultMap>

    <select id="findByUniversityId" resultMap="majorResultMap">
        SELECT id, university_id, name
        FROM majors
        WHERE university_id = #{universityId}
        ORDER BY name ASC
    </select>

    <select id="findByUniversityIdAndKeyword" resultMap="majorResultMap">
        SELECT id, university_id, name
        FROM majors
        WHERE university_id = #{universityId}
          AND name ILIKE '%' || #{keyword} || '%'
        ORDER BY name ASC
    </select>

    <select id="findById" resultMap="majorResultMap">
        SELECT id, university_id, name
        FROM majors
        WHERE id = #{id}
    </select>

    <select id="existsByIdAndUniversityId" resultType="boolean">
        SELECT EXISTS(
            SELECT 1 FROM majors
            WHERE id = #{id} AND university_id = #{universityId}
        )
    </select>

</mapper>
